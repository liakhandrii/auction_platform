<style type="text/css">
  body {
    background-color: #dddddd;
  }

  .center-block {
    display: block;
    margin-left: auto;
    margin-right: auto;
    background-color: #fff;
    border-radius: 5px;
    border: none;
    -webkit-box-shadow: 0px 0px 10px 1px rgba(0, 0, 0, 0.2);
    -moz-box-shadow: 0px 0px 10px 1px rgba(0, 0, 0, 0.2);
    box-shadow: 0px 0px 10px 1px rgba(0, 0, 0, 0.2);
  }

  #info_block {
    margin-top: 10%;
    width: 400px;
    height: 450px;
  }

  #about_block {
    width: auto;
    height: 150px;
    margin: 6%;
    position: relative;
    top: 5%;
    border-radius: 3px;
    background-color: #d9edf7;
    border: 1px solid #bce8f1;
  }

  .about_text {
    color: #3a8bc5;
    margin: 5%;
  }

  .input-group {
    width: 70%;
    margin-left: 15%;
    top: 30px;
    margin-top: 25px;
  }

  .input-group-btn > .glyphicon {
    top: 0px;
  }

  #done_button {
    width: 30%;
    margin-top: 70px;
    margin-left: 35%;
  }
</style>
<% if current_user %>
    <div id="info_block" class="center-block">
      <div class="text-center">
        <%= image_tag(@auth['info']['image'], width: '100', height: '100', class: 'img-circle') %>
      </div>
      <div id="about_block">
        <h5 class="about_text"><strong>Hey, <%= current_user.name %>!</strong> Here is the message specially for you.
        </h5>
        <h5 class="about_text"><strong>We just need a little but more information about you.</strong></h5>
        <h5 class="about_text">Please, write down your true name and phone number.</h5>
        <div id="formInfo"></div>
      </div>
      <form action="info/update" name="userForm">
        <div class="input-group input-group-lg">
          <span class="input-group-addon glyphicon glyphicon-user" id="basic-addon1" style="top: 0px;"></span>
          <input type="text" class="form-control" placeholder="Name" aria-describedby="basic-addon1" value="<%= current_user.name %>"
                 name="name" id="name">
        </div>
        <div class="input-group input-group-lg">
          <span class="input-group-addon glyphicon glyphicon-earphone" id="basic-addon1" style="top: 0px;"></span>
          <input type="text" class="form-control" placeholder="Phone" aria-describedby="basic-addon1" name="phone" id="phone">
        </div>
        <%= hidden_field_tag :authenticity_token, form_authenticity_token %>
        <div>
          <a class="bt1n btn-success btn-lg" href="javascript:checkForm()">
            Done
          </a>
        </div>
      </form>
    </div>
    <script>
      function checkForm() {
        var name = document.getElementById('name').value;
        var phone = document.getElementById('phone').value;

        if (name.length > 0 && phone.length > 9) {
          if (isValidUkrainianNumber(phone))
            document.userForm.submit();
          else
            document.getElementById('formInfo').innerHTML = '<div class="alert alert-danger"> Phone is not correct </div>';
        } else {
          document.getElementById('formInfo').innerHTML = '<div class="alert alert-danger"> All fields should be filled</div>';
        }
      }

      function isValidUkrainianNumber(number) {
        if (number.length == 13 && number.substr(0, 4) == "+380" && $.isNumeric(number.substr(1)))
          return true;
        else if (number.length == 10 && number.substr(0, 1) == "0" && $.isNumeric(number))
          return true;
        return false;
      }
    </script>
<% end %>